import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useParams, useNavigate } from 'react-router-dom';
import { useGetReceiptQuery } from '../../features/api/paymentApi';
import { ArrowLeft, Download, Printer, CheckCircle, Car, User, DollarSign, Shield } from 'lucide-react';
import { format } from 'date-fns';
const ReceiptDetailPage = () => {
    const { paymentId } = useParams();
    const navigate = useNavigate();
    const { data: receiptData, isLoading, error } = useGetReceiptQuery({ paymentId: Number(paymentId) }, { skip: !paymentId });
    const handlePrint = () => {
        window.print();
    };
    const handleDownload = () => {
        // Similar download logic as before
        window.open(`/api/payments/${paymentId}/receipt?download=true`, '_blank');
    };
    if (isLoading) {
        return _jsx("div", { children: "Loading receipt..." });
    }
    if (error || !receiptData) {
        return _jsx("div", { children: "Receipt not found" });
    }
    const { payment, booking, user } = receiptData.data;
    return (_jsx("div", { className: "min-h-screen bg-gray-50 p-6 print:p-0", children: _jsxs("div", { className: "max-w-4xl mx-auto", children: [_jsx("div", { className: "mb-6 print:hidden", children: _jsxs("button", { onClick: () => navigate(-1), className: "flex items-center gap-2 text-[#027480] hover:text-[#02606d]", children: [_jsx(ArrowLeft, { size: 20 }), "Back to Payments"] }) }), _jsxs("div", { className: "bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden print:shadow-none print:border-0", children: [_jsx("div", { className: "bg-gradient-to-r from-[#027480] to-[#014d57] p-8 text-white", children: _jsxs("div", { className: "flex justify-between items-start", children: [_jsxs("div", { children: [_jsx("h1", { className: "text-3xl font-bold mb-2", children: "Payment Receipt" }), _jsxs("p", { className: "opacity-90", children: ["Transaction #", payment.transaction_id] })] }), _jsxs("div", { className: "text-right", children: [_jsxs("div", { className: "inline-flex items-center gap-2 bg-white/20 px-4 py-2 rounded-full", children: [_jsx(CheckCircle, { size: 20 }), _jsx("span", { className: "font-semibold", children: payment.payment_status })] }), _jsx("p", { className: "mt-2 opacity-90", children: format(new Date(payment.payment_date), 'MMMM dd, yyyy â€¢ hh:mm a') })] })] }) }), _jsxs("div", { className: "p-8", children: [_jsxs("div", { className: "grid grid-cols-1 md:grid-cols-2 gap-8 mb-8", children: [_jsxs("div", { className: "space-y-6", children: [_jsxs("div", { children: [_jsxs("h3", { className: "text-lg font-bold text-gray-800 mb-4 flex items-center gap-2", children: [_jsx(DollarSign, { size: 20, className: "text-[#027480]" }), "Payment Information"] }), _jsxs("div", { className: "space-y-3", children: [_jsx(DetailRow, { label: "Transaction ID", value: payment.transaction_id }), _jsx(DetailRow, { label: "Payment Method", value: payment.payment_method }), _jsx(DetailRow, { label: "Phone Number", value: payment.phone }), _jsx(DetailRow, { label: "Gross Amount", value: `KES ${payment.gross_amount.toLocaleString()}` }), _jsx(DetailRow, { label: "Commission Fee", value: `KES ${payment.commission_fee.toLocaleString()}` }), _jsx(DetailRow, { label: "Net Amount", value: `KES ${payment.net_amount.toLocaleString()}`, highlight: true })] })] }), _jsxs("div", { children: [_jsxs("h3", { className: "text-lg font-bold text-gray-800 mb-4 flex items-center gap-2", children: [_jsx(User, { size: 20, className: "text-[#027480]" }), "Customer Information"] }), _jsxs("div", { className: "space-y-3", children: [_jsx(DetailRow, { label: "Name", value: `${user.first_name} ${user.last_name}` }), _jsx(DetailRow, { label: "Email", value: user.email }), _jsx(DetailRow, { label: "Phone", value: user.contact_phone }), user.address && _jsx(DetailRow, { label: "Address", value: user.address })] })] })] }), _jsxs("div", { className: "space-y-6", children: [_jsxs("div", { children: [_jsxs("h3", { className: "text-lg font-bold text-gray-800 mb-4 flex items-center gap-2", children: [_jsx(Car, { size: 20, className: "text-[#027480]" }), "Booking Information"] }), _jsxs("div", { className: "space-y-3", children: [_jsx(DetailRow, { label: "Booking ID", value: `#${booking.booking_id}` }), _jsx(DetailRow, { label: "Vehicle", value: `${booking.vehicle_manufacturer} ${booking.vehicle_model}` }), _jsx(DetailRow, { label: "Year", value: booking.vehicle_year.toString() }), booking.license_plate && _jsx(DetailRow, { label: "License Plate", value: booking.license_plate }), booking.vin_number && _jsx(DetailRow, { label: "VIN", value: booking.vin_number }), _jsx(DetailRow, { label: "Pickup Date", value: format(new Date(booking.booking_date), 'MMM dd, yyyy') }), _jsx(DetailRow, { label: "Return Date", value: format(new Date(booking.return_date), 'MMM dd, yyyy') }), _jsx(DetailRow, { label: "Total Booking Amount", value: `KES ${booking.total_amount.toLocaleString()}`, highlight: true })] })] }), _jsx("div", { className: "p-4 bg-gray-50 rounded-lg border border-gray-200", children: _jsxs("div", { className: "flex items-center gap-3", children: [_jsx(Shield, { size: 24, className: "text-green-500" }), _jsxs("div", { children: [_jsx("p", { className: "font-medium text-gray-800", children: "Secured Transaction" }), _jsx("p", { className: "text-sm text-gray-600", children: "This receipt has been digitally signed and verified" })] })] }) })] })] }), _jsx("div", { className: "border-t border-gray-200 pt-6", children: _jsx("p", { className: "text-sm text-gray-600 text-center", children: "Thank you for your business! This receipt serves as official proof of payment. For any queries, please contact our support team." }) })] })] }), _jsxs("div", { className: "flex justify-center gap-4 mt-8 print:hidden", children: [_jsxs("button", { onClick: handlePrint, className: "flex items-center gap-2 px-6 py-3 bg-[#027480] text-white rounded-lg hover:bg-[#02606d] transition-colors", children: [_jsx(Printer, { size: 20 }), "Print Receipt"] }), _jsxs("button", { onClick: handleDownload, className: "flex items-center gap-2 px-6 py-3 border border-[#445048] text-gray-700 rounded-lg hover:bg-gray-50 transition-colors", children: [_jsx(Download, { size: 20 }), "Download PDF"] })] })] }) }));
};
const DetailRow = ({ label, value, highlight = false }) => (_jsxs("div", { className: "flex justify-between items-center py-2 border-b border-gray-100 last:border-0", children: [_jsx("span", { className: "text-gray-600", children: label }), _jsx("span", { className: `font-medium ${highlight ? 'text-[#027480] text-lg' : 'text-gray-800'}`, children: value })] }));
export default ReceiptDetailPage;
